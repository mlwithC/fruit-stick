<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fruitsticks POS</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root {
            --primary: #FF69B4;
            --secondary: #FFB6D9;
            --accent: #8B4789;
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #f44336;
            --bg: #FFF5F8;
            --card: #FFFFFF;
            --text: #2C2C2C;
            --text-light: #666;
            --shadow: 0 4px 20px rgba(255, 105, 180, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            padding: 1.5rem 1rem;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-family: 'Fredoka', sans-serif;
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .nav-tabs {
            display: flex;
            background: white;
            box-shadow: var(--shadow);
            margin: 1rem;
            border-radius: 15px;
            overflow-x: auto;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
        }

        .nav-tabs::-webkit-scrollbar {
            height: 4px;
        }

        .nav-tabs::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 10px;
        }

        .nav-tab {
            flex: 0 0 auto;
            min-width: 100px;
            padding: 1rem;
            border: none;
            background: white;
            color: var(--text-light);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
            white-space: nowrap;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            transform: scale(1.05);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
            padding-bottom: 180px; /* Space for cart summary */
        }

        .search-box {
            margin-bottom: 1rem;
        }

        .search-box input {
            width: 100%;
            padding: 0.9rem 1.2rem;
            border: 2px solid var(--secondary);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Outfit', sans-serif;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 105, 180, 0.1);
        }

        .category-section {
            margin-bottom: 2rem;
        }

        .category-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.4rem;
            color: var(--accent);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--secondary);
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 0.8rem;
        }

        .product-card {
            background: var(--card);
            border-radius: 15px;
            padding: 1rem;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .product-card:active {
            transform: scale(0.95);
        }

        .product-card.selected {
            border-color: var(--primary);
            box-shadow: 0 4px 25px rgba(255, 105, 180, 0.3);
        }

        .product-card.low-stock {
            border-left: 4px solid var(--warning);
        }

        .product-card.out-of-stock {
            opacity: 0.5;
            cursor: not-allowed;
            border-left: 4px solid var(--danger);
        }

        .product-name {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .product-price {
            color: var(--primary);
            font-weight: 700;
            font-size: 1.1rem;
            font-family: 'Fredoka', sans-serif;
        }

        .product-stock {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 0.3rem;
        }

        .quantity-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--primary);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .cart-summary {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 1rem;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
            z-index: 50;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .cart-total-amount {
            font-size: 1.6rem;
            color: var(--primary);
            font-family: 'Fredoka', sans-serif;
            font-weight: 700;
        }

        .cart-actions {
            display: flex;
            gap: 0.8rem;
        }

        .btn {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            font-family: 'Outfit', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
        }

        .btn-primary:active {
            transform: scale(0.97);
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--text);
        }

        .sales-list {
            margin-bottom: 5rem;
        }

        .sale-card {
            background: var(--card);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
        }

        .sale-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            padding-bottom: 0.8rem;
            border-bottom: 2px solid var(--bg);
        }

        .sale-date {
            font-weight: 600;
            color: var(--accent);
        }

        .sale-total {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
            font-family: 'Fredoka', sans-serif;
        }

        .sale-items {
            font-size: 0.9rem;
            color: var(--text-light);
            line-height: 1.6;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card);
            border-radius: 12px;
            padding: 1.2rem;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            font-family: 'Fredoka', sans-serif;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 0.3rem;
        }

        .top-products {
            margin-bottom: 2rem;
        }

        .top-product {
            background: var(--card);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-product-rank {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
        }

        .top-product-info {
            flex: 1;
            margin-left: 1rem;
        }

        .top-product-name {
            font-weight: 600;
            color: var(--text);
        }

        .top-product-count {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .top-product-revenue {
            font-weight: 700;
            color: var(--primary);
            font-family: 'Fredoka', sans-serif;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-title {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text);
        }

        .form-group input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid var(--secondary);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Outfit', sans-serif;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .inventory-list {
            margin-bottom: 5rem;
        }

        .inventory-item {
            background: var(--card);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .inventory-item.low-stock {
            border-left: 4px solid var(--warning);
        }

        .inventory-item.out-of-stock {
            border-left: 4px solid var(--danger);
        }

        .inventory-info {
            flex: 1;
        }

        .inventory-name {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .inventory-stock {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .inventory-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-add {
            background: var(--success);
            color: white;
        }

        .btn-remove {
            background: var(--danger);
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-light);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .filter-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .filter-btn {
            padding: 0.6rem 1.2rem;
            border: 2px solid var(--secondary);
            background: white;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
        }

        .setting-section {
            margin-bottom: 2rem;
        }

        .setting-card {
            background: var(--card);
            border-radius: 12px;
            padding: 1.2rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .setting-info {
            flex: 1;
        }

        .setting-title {
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: var(--text);
        }

        .setting-desc {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .info-card {
            background: var(--card);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            line-height: 1.8;
            color: var(--text);
        }

        .report-card {
            background: var(--card);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .report-icon {
            font-size: 2.5rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            border-radius: 12px;
        }

        .report-info {
            flex: 1;
        }

        .report-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
            color: var(--text);
        }

        .report-desc {
            font-size: 0.85rem;
            color: var(--text-light);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üç¶ FRUITSTICKS POS</h1>
    </div>

    <div class="nav-tabs">
        <button class="nav-tab active" onclick="switchTab('sell')">üí∞ Sell</button>
        <button class="nav-tab" onclick="switchTab('sales')">üìä Sales</button>
        <button class="nav-tab" onclick="switchTab('dashboard')">üìà Dashboard</button>
        <button class="nav-tab" onclick="switchTab('inventory')">üì¶ Inventory</button>
        <button class="nav-tab" onclick="switchTab('reports')">üìÑ Reports</button>
        <button class="nav-tab" onclick="switchTab('settings')">‚öôÔ∏è Settings</button>
    </div>

    <!-- SELL TAB -->
    <div id="sell-tab" class="tab-content active">
        <div class="container">
            <div class="search-box">
                <input type="text" id="search-input" placeholder="üîç Search ice cream..." oninput="filterProducts()">
            </div>

            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterByCategory('all')">All</button>
                <button class="filter-btn" onclick="filterByCategory('sticks-20')">Sticks ‚Çπ20</button>
                <button class="filter-btn" onclick="filterByCategory('sticks-25')">Sticks ‚Çπ25</button>
                <button class="filter-btn" onclick="filterByCategory('tubs')">Tubs</button>
                <button class="filter-btn" onclick="filterByCategory('family-pack')">Family Pack</button>
                <button class="filter-btn" onclick="filterByCategory('kulfi')">Kulfi</button>
            </div>

            <div id="products-container"></div>
        </div>

        <div class="cart-summary">
            <div class="cart-total">
                <span>Total:</span>
                <span class="cart-total-amount" id="cart-total">‚Çπ0</span>
            </div>
            <div class="cart-actions">
                <button class="btn btn-secondary" onclick="clearCart()">Clear</button>
                <button class="btn btn-primary" onclick="completeSale()">Complete Sale</button>
            </div>
        </div>
    </div>

    <!-- SALES TAB -->
    <div id="sales-tab" class="tab-content">
        <div class="container">
            <h2 class="category-title">Recent Sales</h2>
            <div id="sales-list" class="sales-list"></div>
        </div>
    </div>

    <!-- DASHBOARD TAB -->
    <div id="dashboard-tab" class="tab-content">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-sales-count">0</div>
                    <div class="stat-label">Total Sales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-revenue">‚Çπ0</div>
                    <div class="stat-label">Total Revenue</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="items-sold">0</div>
                    <div class="stat-label">Items Sold</div>
                </div>
            </div>

            <h2 class="category-title">Top Selling Products</h2>
            <div id="top-products" class="top-products"></div>

            <h2 class="category-title">Low Stock Alerts</h2>
            <div id="low-stock-alerts"></div>
        </div>
    </div>

    <!-- INVENTORY TAB -->
    <div id="inventory-tab" class="tab-content">
        <div class="container">
            <h2 class="category-title">Stock Management</h2>
            <div id="inventory-list" class="inventory-list"></div>
        </div>
    </div>

    <!-- REPORTS TAB -->
    <div id="reports-tab" class="tab-content">
        <div class="container">
            <h2 class="category-title">üìÑ Sales Reports</h2>
            
            <div class="report-card">
                <div class="report-icon">üìÖ</div>
                <div class="report-info">
                    <div class="report-title">Weekly Sales Report</div>
                    <div class="report-desc">Download PDF report for the last 7 days</div>
                </div>
                <button class="btn btn-primary" style="max-width: 150px;" onclick="generateWeeklyReport()">Download PDF</button>
            </div>

            <div class="report-card">
                <div class="report-icon">üìÜ</div>
                <div class="report-info">
                    <div class="report-title">Monthly Sales Report</div>
                    <div class="report-desc">Download PDF report for the last 30 days</div>
                </div>
                <button class="btn btn-primary" style="max-width: 150px;" onclick="generateMonthlyReport()">Download PDF</button>
            </div>

            <div class="report-card">
                <div class="report-icon">üìä</div>
                <div class="report-info">
                    <div class="report-title">All Time Report</div>
                    <div class="report-desc">Download complete sales history report</div>
                </div>
                <button class="btn btn-primary" style="max-width: 150px;" onclick="generateAllTimeReport()">Download PDF</button>
            </div>

            <div style="margin-top: 2rem; padding: 1rem; background: var(--card); border-radius: 12px; box-shadow: var(--shadow);">
                <h3 style="font-weight: 600; margin-bottom: 0.5rem; color: var(--accent);">üìã Report Includes:</h3>
                <ul style="line-height: 2; color: var(--text-light); margin-left: 1.5rem;">
                    <li>Total sales and revenue</li>
                    <li>Items sold breakdown</li>
                    <li>Top selling products</li>
                    <li>Daily sales summary</li>
                    <li>Current stock levels</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- SETTINGS TAB -->
    <div id="settings-tab" class="tab-content">
        <div class="container">
            <h2 class="category-title">‚öôÔ∏è Settings</h2>
            
            <div class="setting-section">
                <h3 style="font-weight: 600; margin-bottom: 1rem; color: var(--text);">Product Management</h3>
                
                <div class="setting-card">
                    <div class="setting-info">
                        <div class="setting-title">Add New Product</div>
                        <div class="setting-desc">Add a new ice cream flavor to your menu</div>
                    </div>
                    <button class="btn btn-primary" style="max-width: 150px;" onclick="openAddProductModal()">Add Product</button>
                </div>

                <div class="setting-card">
                    <div class="setting-info">
                        <div class="setting-title">Edit/Delete Products</div>
                        <div class="setting-desc">Modify or remove existing products</div>
                    </div>
                    <button class="btn" style="background: var(--accent); color: white; max-width: 150px;" onclick="openManageProductsModal()">Manage</button>
                </div>
            </div>

            <div class="setting-section" style="margin-top: 2rem;">
                <h3 style="font-weight: 600; margin-bottom: 1rem; color: var(--text);">Clear Data</h3>
                
                <div class="setting-card">
                    <div class="setting-info">
                        <div class="setting-title">Clear All Sales History</div>
                        <div class="setting-desc">Delete all sales records. This cannot be undone!</div>
                    </div>
                    <button class="btn" style="background: var(--danger); color: white; max-width: 150px;" onclick="clearSalesHistory()">Clear Sales</button>
                </div>

                <div class="setting-card">
                    <div class="setting-info">
                        <div class="setting-title">Reset All Stock to 50</div>
                        <div class="setting-desc">Reset inventory quantities to 50 for all items</div>
                    </div>
                    <button class="btn" style="background: var(--warning); color: white; max-width: 150px;" onclick="resetInventory()">Reset Stock</button>
                </div>

                <div class="setting-card">
                    <div class="setting-info">
                        <div class="setting-title">Clear Everything & Start Fresh</div>
                        <div class="setting-desc">Delete all sales AND reset stock. Complete reset!</div>
                    </div>
                    <button class="btn" style="background: var(--danger); color: white; max-width: 150px;" onclick="clearEverything()">Reset All</button>
                </div>
            </div>


        </div>
    </div>

    <!-- Stock Update Modal -->
    <div id="stock-modal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Update Stock</h2>
            <div class="form-group">
                <label id="modal-product-name"></label>
                <label>New Stock Quantity:</label>
                <input type="number" id="stock-input" min="0" placeholder="Enter quantity">
            </div>
            <div class="cart-actions">
                <button class="btn btn-secondary" onclick="closeStockModal()">Cancel</button>
                <button class="btn btn-primary" onclick="updateStock()">Update</button>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div id="add-product-modal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Add New Product</h2>
            <div class="form-group">
                <label>Product Name:</label>
                <input type="text" id="new-product-name" placeholder="Enter product name">
            </div>
            <div class="form-group">
                <label>Price (‚Çπ):</label>
                <input type="number" id="new-product-price" min="1" placeholder="Enter price">
            </div>
            <div class="form-group">
                <label>Category:</label>
                <select id="new-product-category" style="width: 100%; padding: 0.8rem; border: 2px solid var(--secondary); border-radius: 8px; font-size: 1rem; font-family: 'Outfit', sans-serif;">
                    <option value="sticks-20">Sticks ‚Çπ20</option>
                    <option value="sticks-25">Sticks ‚Çπ25</option>
                    <option value="tubs">150ml Tubs</option>
                    <option value="family-pack">Family Pack</option>
                    <option value="kulfi">Kulfi</option>
                </select>
            </div>
            <div class="form-group">
                <label>Initial Stock:</label>
                <input type="number" id="new-product-stock" min="0" value="50" placeholder="Enter stock quantity">
            </div>
            <div class="cart-actions">
                <button class="btn btn-secondary" onclick="closeAddProductModal()">Cancel</button>
                <button class="btn btn-primary" onclick="addNewProduct()">Add</button>
            </div>
        </div>
    </div>

    <!-- Manage Products Modal -->
    <div id="manage-products-modal" class="modal">
        <div class="modal-content" style="max-width: 500px; max-height: 80vh; overflow-y: auto;">
            <h2 class="modal-title">Manage Products</h2>
            <div id="products-manage-list"></div>
            <div style="margin-top: 1rem;">
                <button class="btn btn-secondary" onclick="closeManageProductsModal()" style="width: 100%;">Close</button>
            </div>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div id="edit-product-modal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Edit Product</h2>
            <div class="form-group">
                <label>Product Name:</label>
                <input type="text" id="edit-product-name" placeholder="Enter product name">
            </div>
            <div class="form-group">
                <label>Price (‚Çπ):</label>
                <input type="number" id="edit-product-price" min="1" placeholder="Enter price">
            </div>
            <div class="cart-actions">
                <button class="btn btn-secondary" onclick="closeEditProductModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveProductEdit()">Save</button>
            </div>
        </div>
    </div>

    <script>
        // Product data from menu
        const PRODUCTS = {
            'sticks-20': [
                'Milk', 'Semiya', 'Butter scotch', 'Coffee', 'Chikku', 'Muskmelon', 'Banana', 'Oreo',
                'Peanut', 'Grape', 'Red guava', 'Pineapple', 'Watermelon', 'Badham', 'Pistha', 'Green apple'
            ],
            'sticks-25': [
                'Mango', 'Black currant', 'Strawberry', 'Blueberry', 'Chocolate', 'Arabian delight', 'Spanish delight', 'Tender coconut',
                'Rasamalai', 'Gulkand', 'Litchy', 'Gulab jamun', 'Jackfruit', 'Raw mango', 'Paan', 'White guava',
                'Sharjah dates', 'Jamun', 'Fig', 'Kiwi'
            ],
            'tubs': [
                { name: 'Chocolate Tub', price: 50 },
                { name: 'Oreo Tub', price: 50 },
                { name: 'Gulkanth Tub', price: 50 },
                { name: 'Tender Coconut Tub', price: 50 },
                { name: 'Jack Fruit Tub', price: 50 },
                { name: 'Creamy malai Tub', price: 50 }
            ],
            'family-pack': [
                { name: 'Oreo Family Pack', price: 180 },
                { name: 'Chocolate Family Pack', price: 180 },
                { name: 'Jack fruit Family Pack', price: 180 },
                { name: 'Tender Coconut Family Pack', price: 180 },
                { name: 'Gulkanth Family Pack', price: 180 },
                { name: 'Family Pot', price: 180 }
            ],
            'kulfi': [
                { name: 'Kesar badam kulfi', price: 50 },
                { name: 'Kesar pista kulfi', price: 50 },
                { name: 'Mango kulfi', price: 50 },
                { name: 'Tender kulfi', price: 50 },
                { name: 'Gulkanth kulfi', price: 50 },
                { name: 'Oreo kulfi', price: 50 },
                { name: 'Malai', price: 25 },
                { name: 'Nutty chocobar', price: 30 },
                { name: 'Punjabi', price: 40 },
                { name: 'Cornetto cone', price: 40 },
                { name: 'Mud ka pot', price: 50 },
                { name: 'Abukkatta roll', price: 50 }
            ]
        };

        // Initialize inventory
        let inventory = {};
        let cart = {};
        let sales = [];
        let currentCategory = 'all';
        let currentStockProduct = null;

        // Load data from localStorage
        function loadData() {
            const savedInventory = localStorage.getItem('inventory');
            const savedSales = localStorage.getItem('sales');
            
            if (savedInventory) {
                inventory = JSON.parse(savedInventory);
            } else {
                // Initialize with default stock
                Object.keys(PRODUCTS).forEach(category => {
                    PRODUCTS[category].forEach(product => {
                        const name = typeof product === 'string' ? product : product.name;
                        const price = typeof product === 'string' ? 
                            (category === 'sticks-20' ? 20 : 25) : 
                            product.price;
                        inventory[name] = { 
                            stock: 50, 
                            price: price,
                            category: category 
                        };
                    });
                });
                saveData();
            }

            if (savedSales) {
                sales = JSON.parse(savedSales);
            }
        }

        function saveData() {
            localStorage.setItem('inventory', JSON.stringify(inventory));
            localStorage.setItem('sales', JSON.stringify(sales));
        }

        // Render products
        function renderProducts() {
            const container = document.getElementById('products-container');
            container.innerHTML = '';

            Object.keys(PRODUCTS).forEach(category => {
                if (currentCategory !== 'all' && currentCategory !== category) return;

                const section = document.createElement('div');
                section.className = 'category-section';
                
                const title = document.createElement('h2');
                title.className = 'category-title';
                title.textContent = category === 'sticks-20' ? 'Sticks - ‚Çπ20' :
                                   category === 'sticks-25' ? 'Sticks - ‚Çπ25' :
                                   category === 'tubs' ? '150ml Tubs' :
                                   category === 'family-pack' ? 'Family Pack (500ml)' :
                                   category === 'kulfi' ? 'Kulfi' : 'Other';
                section.appendChild(title);

                const grid = document.createElement('div');
                grid.className = 'product-grid';

                PRODUCTS[category].forEach(product => {
                    const name = typeof product === 'string' ? product : product.name;
                    const productData = inventory[name];
                    
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    
                    if (productData.stock === 0) {
                        card.classList.add('out-of-stock');
                    } else if (productData.stock <= 5) {
                        card.classList.add('low-stock');
                    }

                    if (cart[name]) {
                        card.classList.add('selected');
                    }

                    card.innerHTML = `
                        <div class="product-name">${name}</div>
                        <div class="product-price">‚Çπ${productData.price}</div>
                        <div class="product-stock">Stock: ${productData.stock}</div>
                        ${cart[name] ? `<div class="quantity-badge">${cart[name]}</div>` : ''}
                    `;

                    if (productData.stock > 0) {
                        card.onclick = () => addToCart(name);
                    }

                    grid.appendChild(card);
                });

                section.appendChild(grid);
                container.appendChild(section);
            });
        }

        function filterProducts() {
            const search = document.getElementById('search-input').value.toLowerCase();
            const cards = document.querySelectorAll('.product-card');
            
            cards.forEach(card => {
                const name = card.querySelector('.product-name').textContent.toLowerCase();
                if (name.includes(search)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function filterByCategory(category) {
            currentCategory = category;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            renderProducts();
        }

        function addToCart(productName) {
            if (inventory[productName].stock === 0) return;

            if (!cart[productName]) {
                cart[productName] = 0;
            }
            
            if (cart[productName] < inventory[productName].stock) {
                cart[productName]++;
                updateCartTotal();
                renderProducts();
            }
        }

        function updateCartTotal() {
            let total = 0;
            Object.keys(cart).forEach(productName => {
                total += cart[productName] * inventory[productName].price;
            });
            document.getElementById('cart-total').textContent = `‚Çπ${total}`;
        }

        function clearCart() {
            cart = {};
            updateCartTotal();
            renderProducts();
        }

        function completeSale() {
            if (Object.keys(cart).length === 0) {
                alert('Cart is empty!');
                return;
            }

            // Reduce stock
            Object.keys(cart).forEach(productName => {
                inventory[productName].stock -= cart[productName];
            });

            // Record sale
            const sale = {
                id: Date.now(),
                date: new Date().toLocaleString(),
                items: { ...cart },
                total: Object.keys(cart).reduce((sum, name) => 
                    sum + (cart[name] * inventory[name].price), 0)
            };
            sales.unshift(sale);

            saveData();
            clearCart();
            alert('Sale completed successfully! ‚úÖ');
            renderProducts();
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(navTab => {
                navTab.classList.remove('active');
            });

            document.getElementById(`${tab}-tab`).classList.add('active');
            event.target.classList.add('active');

            if (tab === 'sales') renderSales();
            if (tab === 'dashboard') renderDashboard();
            if (tab === 'inventory') renderInventory();
        }

        function renderSales() {
            const container = document.getElementById('sales-list');
            
            if (sales.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì≠</div>
                        <div>No sales yet</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = sales.map(sale => `
                <div class="sale-card">
                    <div class="sale-header">
                        <div class="sale-date">${sale.date}</div>
                        <div class="sale-total">‚Çπ${sale.total}</div>
                    </div>
                    <div class="sale-items">
                        ${Object.keys(sale.items).map(name => 
                            `${name} x ${sale.items[name]}`
                        ).join(' ‚Ä¢ ')}
                    </div>
                </div>
            `).join('');
        }

        function renderDashboard() {
            const totalSales = sales.length;
            const totalRevenue = sales.reduce((sum, sale) => sum + sale.total, 0);
            const totalItems = sales.reduce((sum, sale) => 
                sum + Object.values(sale.items).reduce((a, b) => a + b, 0), 0);

            document.getElementById('total-sales-count').textContent = totalSales;
            document.getElementById('total-revenue').textContent = `‚Çπ${totalRevenue}`;
            document.getElementById('items-sold').textContent = totalItems;

            // Calculate top products
            const productSales = {};
            sales.forEach(sale => {
                Object.keys(sale.items).forEach(name => {
                    if (!productSales[name]) {
                        productSales[name] = { count: 0, revenue: 0 };
                    }
                    productSales[name].count += sale.items[name];
                    productSales[name].revenue += sale.items[name] * inventory[name].price;
                });
            });

            const topProducts = Object.keys(productSales)
                .sort((a, b) => productSales[b].count - productSales[a].count)
                .slice(0, 10);

            const topContainer = document.getElementById('top-products');
            if (topProducts.length === 0) {
                topContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìä</div>
                        <div>No sales data yet</div>
                    </div>
                `;
            } else {
                topContainer.innerHTML = topProducts.map((name, index) => `
                    <div class="top-product">
                        <div class="top-product-rank">${index + 1}</div>
                        <div class="top-product-info">
                            <div class="top-product-name">${name}</div>
                            <div class="top-product-count">${productSales[name].count} sold</div>
                        </div>
                        <div class="top-product-revenue">‚Çπ${productSales[name].revenue}</div>
                    </div>
                `).join('');
            }

            // Low stock alerts
            const lowStock = Object.keys(inventory)
                .filter(name => inventory[name].stock <= 5 && inventory[name].stock > 0)
                .sort((a, b) => inventory[a].stock - inventory[b].stock);

            const lowStockContainer = document.getElementById('low-stock-alerts');
            if (lowStock.length === 0) {
                lowStockContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚úÖ</div>
                        <div>All products well stocked!</div>
                    </div>
                `;
            } else {
                lowStockContainer.innerHTML = lowStock.map(name => `
                    <div class="inventory-item low-stock">
                        <div class="inventory-info">
                            <div class="inventory-name">${name}</div>
                            <div class="inventory-stock">Only ${inventory[name].stock} left!</div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function renderInventory() {
            const container = document.getElementById('inventory-list');
            const items = Object.keys(inventory).sort();

            container.innerHTML = items.map(name => {
                const item = inventory[name];
                const className = item.stock === 0 ? 'out-of-stock' : 
                                item.stock <= 5 ? 'low-stock' : '';
                
                return `
                    <div class="inventory-item ${className}">
                        <div class="inventory-info">
                            <div class="inventory-name">${name}</div>
                            <div class="inventory-stock">Stock: ${item.stock} | Price: ‚Çπ${item.price}</div>
                        </div>
                        <div class="inventory-actions">
                            <button class="btn-small btn-remove" onclick="adjustStock('${name}', -1)">-</button>
                            <button class="btn-small btn-add" onclick="adjustStock('${name}', 1)">+</button>
                            <button class="btn-small" style="background: var(--accent); color: white;" onclick="openStockModal('${name}')">‚úèÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function adjustStock(productName, change) {
            inventory[productName].stock = Math.max(0, inventory[productName].stock + change);
            saveData();
            renderInventory();
        }

        function openStockModal(productName) {
            currentStockProduct = productName;
            document.getElementById('modal-product-name').textContent = productName;
            document.getElementById('stock-input').value = inventory[productName].stock;
            document.getElementById('stock-modal').classList.add('active');
        }

        function closeStockModal() {
            document.getElementById('stock-modal').classList.remove('active');
            currentStockProduct = null;
        }

        function updateStock() {
            const newStock = parseInt(document.getElementById('stock-input').value);
            if (isNaN(newStock) || newStock < 0) {
                alert('Please enter a valid quantity');
                return;
            }

            inventory[currentStockProduct].stock = newStock;
            saveData();
            closeStockModal();
            renderInventory();
        }

        // Initialize app
        loadData();
        renderProducts();

        // Settings functions
        function clearSalesHistory() {
            if (confirm('Are you sure you want to delete ALL sales history? This cannot be undone!')) {
                sales = [];
                saveData();
                alert('‚úÖ Sales history cleared!');
                renderDashboard();
            }
        }

        function resetInventory() {
            if (confirm('Reset all stock quantities to 50?')) {
                Object.keys(inventory).forEach(name => {
                    inventory[name].stock = 50;
                });
                saveData();
                alert('‚úÖ Inventory reset to 50 for all items!');
                renderInventory();
                renderProducts();
            }
        }

        function clearEverything() {
            if (confirm('‚ö†Ô∏è WARNING: This will delete ALL sales AND reset all stock to 50. Are you ABSOLUTELY sure?')) {
                if (confirm('Last chance! Click OK to permanently delete everything.')) {
                    sales = [];
                    Object.keys(inventory).forEach(name => {
                        inventory[name].stock = 50;
                    });
                    saveData();
                    alert('‚úÖ Everything cleared! Starting fresh.');
                    switchTab('sell');
                    renderProducts();
                }
            }
        }

        // Report Generation Functions
        function filterSalesByDays(days) {
            const now = new Date();
            const cutoff = new Date(now.getTime() - (days * 24 * 60 * 60 * 1000));
            
            return sales.filter(sale => {
                const saleDate = new Date(sale.date);
                return saleDate >= cutoff;
            });
        }

        function generateReport(filteredSales, reportTitle, fileName) {
            if (filteredSales.length === 0) {
                alert('No sales data available for this period!');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Title
            doc.setFontSize(20);
            doc.setTextColor(255, 105, 180);
            doc.text('üç¶ FRUITSTICKS', 105, 20, { align: 'center' });
            
            doc.setFontSize(16);
            doc.setTextColor(139, 71, 137);
            doc.text(reportTitle, 105, 30, { align: 'center' });
            
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text(`Generated: ${new Date().toLocaleString()}`, 105, 37, { align: 'center' });
            
            // Summary Stats
            const totalRevenue = filteredSales.reduce((sum, sale) => sum + sale.total, 0);
            const totalItems = filteredSales.reduce((sum, sale) => 
                sum + Object.values(sale.items).reduce((a, b) => a + b, 0), 0);
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            let yPos = 50;
            
            doc.setFillColor(255, 245, 248);
            doc.rect(15, yPos - 5, 180, 25, 'F');
            
            doc.setFont(undefined, 'bold');
            doc.text(`Total Sales: ${filteredSales.length}`, 20, yPos);
            doc.text(`Total Revenue: ‚Çπ${totalRevenue}`, 20, yPos + 7);
            doc.text(`Items Sold: ${totalItems}`, 20, yPos + 14);
            doc.setFont(undefined, 'normal');
            
            yPos += 30;
            
            // Top Products
            const productSales = {};
            filteredSales.forEach(sale => {
                Object.keys(sale.items).forEach(name => {
                    if (!productSales[name]) {
                        productSales[name] = { count: 0, revenue: 0 };
                    }
                    productSales[name].count += sale.items[name];
                    productSales[name].revenue += sale.items[name] * inventory[name].price;
                });
            });
            
            const topProducts = Object.keys(productSales)
                .sort((a, b) => productSales[b].count - productSales[a].count)
                .slice(0, 10);
            
            doc.setFontSize(14);
            doc.setTextColor(139, 71, 137);
            doc.text('Top 10 Selling Products', 20, yPos);
            yPos += 7;
            
            const topProductsData = topProducts.map((name, index) => [
                index + 1,
                name,
                productSales[name].count,
                `‚Çπ${productSales[name].revenue}`
            ]);
            
            doc.autoTable({
                startY: yPos,
                head: [['Rank', 'Product', 'Qty Sold', 'Revenue']],
                body: topProductsData,
                theme: 'striped',
                headStyles: { fillColor: [255, 105, 180], textColor: 255 },
                alternateRowStyles: { fillColor: [255, 245, 248] },
                margin: { left: 20, right: 20 }
            });
            
            yPos = doc.lastAutoTable.finalY + 15;
            
            // Sales by Date
            if (yPos > 250) {
                doc.addPage();
                yPos = 20;
            }
            
            doc.setFontSize(14);
            doc.setTextColor(139, 71, 137);
            doc.text('Sales Transactions', 20, yPos);
            yPos += 7;
            
            const salesData = filteredSales.slice(0, 50).map(sale => {
                const itemsList = Object.keys(sale.items)
                    .map(name => `${name} (${sale.items[name]})`)
                    .join(', ');
                return [
                    sale.date,
                    itemsList.length > 60 ? itemsList.substring(0, 60) + '...' : itemsList,
                    `‚Çπ${sale.total}`
                ];
            });
            
            doc.autoTable({
                startY: yPos,
                head: [['Date & Time', 'Items', 'Total']],
                body: salesData,
                theme: 'striped',
                headStyles: { fillColor: [255, 105, 180], textColor: 255 },
                alternateRowStyles: { fillColor: [255, 245, 248] },
                margin: { left: 20, right: 20 },
                columnStyles: {
                    0: { cellWidth: 45 },
                    1: { cellWidth: 100 },
                    2: { cellWidth: 25 }
                }
            });
            
            yPos = doc.lastAutoTable.finalY + 15;
            
            // Current Stock Status
            if (yPos > 250) {
                doc.addPage();
                yPos = 20;
            }
            
            doc.setFontSize(14);
            doc.setTextColor(139, 71, 137);
            doc.text('Current Stock Levels', 20, yPos);
            yPos += 7;
            
            const stockData = Object.keys(inventory)
                .sort((a, b) => inventory[a].stock - inventory[b].stock)
                .slice(0, 20)
                .map(name => {
                    const item = inventory[name];
                    const status = item.stock === 0 ? 'Out of Stock' : 
                                 item.stock <= 5 ? 'Low Stock' : 'In Stock';
                    return [
                        name,
                        item.stock,
                        `‚Çπ${item.price}`,
                        status
                    ];
                });
            
            doc.autoTable({
                startY: yPos,
                head: [['Product', 'Stock', 'Price', 'Status']],
                body: stockData,
                theme: 'striped',
                headStyles: { fillColor: [255, 105, 180], textColor: 255 },
                alternateRowStyles: { fillColor: [255, 245, 248] },
                margin: { left: 20, right: 20 }
            });
            
            // Save PDF
            doc.save(fileName);
            alert('‚úÖ Report downloaded successfully!');
        }

        function generateWeeklyReport() {
            const filteredSales = filterSalesByDays(7);
            generateReport(filteredSales, 'Weekly Sales Report (Last 7 Days)', 'weekly-sales-report.pdf');
        }

        function generateMonthlyReport() {
            const filteredSales = filterSalesByDays(30);
            generateReport(filteredSales, 'Monthly Sales Report (Last 30 Days)', 'monthly-sales-report.pdf');
        }

        function generateAllTimeReport() {
            generateReport(sales, 'All Time Sales Report', 'all-time-sales-report.pdf');
        }

        // Product Management Functions
        let editingProductName = null;

        function openAddProductModal() {
            document.getElementById('new-product-name').value = '';
            document.getElementById('new-product-price').value = '';
            document.getElementById('new-product-stock').value = '50';
            document.getElementById('add-product-modal').classList.add('active');
        }

        function closeAddProductModal() {
            document.getElementById('add-product-modal').classList.remove('active');
        }

        function addNewProduct() {
            const name = document.getElementById('new-product-name').value.trim();
            const price = parseInt(document.getElementById('new-product-price').value);
            const category = document.getElementById('new-product-category').value;
            const stock = parseInt(document.getElementById('new-product-stock').value);

            if (!name || !price || isNaN(stock)) {
                alert('Please fill in all fields!');
                return;
            }

            if (inventory[name]) {
                alert('A product with this name already exists!');
                return;
            }

            // Add to PRODUCTS object
            if (category === 'sticks-20' || category === 'sticks-25') {
                PRODUCTS[category].push(name);
            } else {
                PRODUCTS[category].push({ name: name, price: price });
            }

            // Add to inventory
            inventory[name] = {
                stock: stock,
                price: price,
                category: category
            };

            saveData();
            closeAddProductModal();
            alert('‚úÖ Product added successfully!');
            renderProducts();
        }

        function openManageProductsModal() {
            const container = document.getElementById('products-manage-list');
            const allProducts = Object.keys(inventory).sort();

            container.innerHTML = allProducts.map(name => {
                const product = inventory[name];
                return `
                    <div style="background: var(--bg); border-radius: 8px; padding: 0.8rem; margin-bottom: 0.8rem; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 600;">${name}</div>
                            <div style="font-size: 0.85rem; color: var(--text-light);">‚Çπ${product.price} | Stock: ${product.stock}</div>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn-small" style="background: var(--accent); color: white;" onclick="openEditProductModal('${name}')">‚úèÔ∏è</button>
                            <button class="btn-small btn-remove" onclick="deleteProduct('${name}')">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('manage-products-modal').classList.add('active');
        }

        function closeManageProductsModal() {
            document.getElementById('manage-products-modal').classList.remove('active');
        }

        function openEditProductModal(productName) {
            editingProductName = productName;
            const product = inventory[productName];
            
            document.getElementById('edit-product-name').value = productName;
            document.getElementById('edit-product-price').value = product.price;
            
            document.getElementById('edit-product-modal').classList.add('active');
        }

        function closeEditProductModal() {
            document.getElementById('edit-product-modal').classList.remove('active');
            editingProductName = null;
        }

        function saveProductEdit() {
            const newName = document.getElementById('edit-product-name').value.trim();
            const newPrice = parseInt(document.getElementById('edit-product-price').value);

            if (!newName || !newPrice) {
                alert('Please fill in all fields!');
                return;
            }

            const oldProduct = inventory[editingProductName];
            const category = oldProduct.category;

            // If name changed, check if new name exists
            if (newName !== editingProductName && inventory[newName]) {
                alert('A product with this name already exists!');
                return;
            }

            // Update in PRODUCTS array
            if (category === 'sticks-20' || category === 'sticks-25') {
                const index = PRODUCTS[category].indexOf(editingProductName);
                if (index > -1) {
                    PRODUCTS[category][index] = newName;
                }
            } else {
                const index = PRODUCTS[category].findIndex(p => p.name === editingProductName);
                if (index > -1) {
                    PRODUCTS[category][index] = { name: newName, price: newPrice };
                }
            }

            // Update inventory
            if (newName !== editingProductName) {
                inventory[newName] = {
                    stock: oldProduct.stock,
                    price: newPrice,
                    category: category
                };
                delete inventory[editingProductName];
            } else {
                inventory[newName].price = newPrice;
            }

            saveData();
            closeEditProductModal();
            closeManageProductsModal();
            alert('‚úÖ Product updated successfully!');
            renderProducts();
        }

        function deleteProduct(productName) {
            if (!confirm(`Are you sure you want to delete "${productName}"? This cannot be undone!`)) {
                return;
            }

            const product = inventory[productName];
            const category = product.category;

            // Remove from PRODUCTS array
            if (category === 'sticks-20' || category === 'sticks-25') {
                const index = PRODUCTS[category].indexOf(productName);
                if (index > -1) {
                    PRODUCTS[category].splice(index, 1);
                }
            } else {
                const index = PRODUCTS[category].findIndex(p => p.name === productName);
                if (index > -1) {
                    PRODUCTS[category].splice(index, 1);
                }
            }

            // Remove from inventory
            delete inventory[productName];

            saveData();
            alert('‚úÖ Product deleted successfully!');
            openManageProductsModal(); // Refresh the list
            renderProducts();
        }
    </script>
</body>
</html>